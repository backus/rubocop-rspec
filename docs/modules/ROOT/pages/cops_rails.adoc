= Rails

== Rails/HttpStatus

|===
| Enabled by default | Safe | Supports autocorrection | VersionAdded | VersionChanged

| Enabled
| Yes
| Yes
| 1.23
| -
|===

Enforces use of symbolic or numeric value to describe HTTP status.

=== Examples

==== `EnforcedStyle: symbolic` (default)

[source,ruby]
----
# bad
it { is_expected.to have_http_status 200 }
it { is_expected.to have_http_status 404 }

# good
it { is_expected.to have_http_status :ok }
it { is_expected.to have_http_status :not_found }
it { is_expected.to have_http_status :success }
it { is_expected.to have_http_status :error }
----

==== `EnforcedStyle: numeric`

[source,ruby]
----
# bad
it { is_expected.to have_http_status :ok }
it { is_expected.to have_http_status :not_found }

# good
it { is_expected.to have_http_status 200 }
it { is_expected.to have_http_status 404 }
it { is_expected.to have_http_status :success }
it { is_expected.to have_http_status :error }
----

=== Configurable attributes

|===
| Name | Default value | Configurable values

| EnforcedStyle
| `symbolic`
| `numeric`, `symbolic`
|===

=== References

* https://www.rubydoc.info/gems/rubocop-rspec/RuboCop/Cop/RSpec/Rails/HttpStatus

== Rails/PersistenceCalledOutsideExample

|===
| Enabled by default | Safe | Supports autocorrection | VersionAdded | VersionChanged

| Enabled
| Yes
| No
| 1.43
| -
|===

Checks for persistence calls outside example blocks.

Prevents persistence calls outside examples which usually run
with some sort of cleanup hook. Saving outside of example causes
records to leak into other tests.

@ example
  # bad - records created outside example group
  describe User do
    User.create!
  end

  describe User do
    user = User.new
    user.save!
  end

  # good - records created inside an example group
  describe User do
    it do
      User.create!
    end
  end

  describe User do
    it do
      user = User.new
      user.save!
    end
  end

=== Configurable attributes

|===
| Name | Default value | Configurable values

| AllowedReceivers
| `[]`
| Array

| AllowedMethods
| `[]`
| Array

| ForbiddenMethods
| `create`, `create!`, `create_or_find_by`, `create_or_find_by!`, `decrement!`, `delete_all`, `delete_by`, `destroy_all`, `destroy_by`, `find_or_create_by`, `find_or_create_by!`, `first_or_create`, `first_or_create!`, `increment!`, `save`, `save!`, `toggle!`, `touch_all`, `update`, `update!`, `update_all`, `update_attribute`, `update_attributes`, `update_column`, `update_columns`, `attributes_for`, `attributes_for_list`, `build`, `build_list`, `build_stubbed`, `build_stubbed_list`, `create_list`, `Fabricate`
| Array

| ForbiddenMethodsWithoutArguments
| `delete`, `destroy`, `destroy!`, `touch`
| Array
|===

=== References

* https://www.rubydoc.info/gems/rubocop-rspec/RuboCop/Cop/RSpec/Rails/PersistenceCalledOutsideExample
